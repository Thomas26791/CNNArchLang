architecture ThreeInputCNN_M14{
    def input Z(0:255)^{H,W,C} image[3]
    def output Q(0:1)^{NUM_CLASSES} predictions

    def conv(filter, channels){
        Convolution(kernel=filter, channels=channels) ->
        Relu()
    }

    def inputGroup(group){
        [group] ->
        conv(filter=(3,3), channels=32, _for=[1->:3]) ->
        MaxPooling(kernel=(2,2), stride=2)
    }

    image ->
    inputGroup(group=[0|:2]) ->
    Concatenate() ->
    conv(filter=(3,3), channels=64) ->
    MaxPooling(kernel=(2,2), stride=2) ->

    FullyConnected(units=32) ->
    Relu() ->
    FullyConnected(units=NUM_CLASSES) ->
    Softmax() ->
    predictions
}