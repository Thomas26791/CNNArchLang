architecture Alexnet_alt{
    def input Z(0:255)^{h=224,w=224,c=3} image
    def output Q(0:1)^{classes=10} predictions

    image ->
    Convolution(kernel=(11,11), channels=96, stride=(4,4), padding="valid") ->
    Lrn(nsize=5, alpha=0.0001, beta=0.75) ->
    MaxPooling(kernel=(3,3), stride=(2,2), padding="valid") ->
    Relu() ->
    Split(n=2) ->
    (
        [0] ->
        Convolution(kernel=(5,5), channels=128) ->
        Lrn(nsize=5, alpha=0.0001, beta=0.75) ->
        MaxPooling(kernel=(3,3), stride=(2,2), padding="valid") ->
        Relu()
    |
        [1] ->
        Convolution(kernel=(5,5), channels=128) ->
        Lrn(nsize=5, alpha=0.0001, beta=0.75) ->
        MaxPooling(kernel=(3,3), stride=(2,2), padding="valid") ->
        Relu()
    ) ->
    Concatenate() ->
    Convolution(kernel=(3,3), channels=384) ->
    Relu() ->
    Split(n=2) ->
    (
        [0] ->
        Convolution(kernel=(3,3), channels=192) ->
        Relu() ->
        Convolution(kernel=(3,3), channels=128) ->
        MaxPooling(kernel=(3,3), stride=(2,2), padding="valid") ->
        Relu()
    |
        [1] ->
        Convolution(kernel=(3,3), channels=192) ->
        Relu() ->
        Convolution(kernel=(3,3), channels=128) ->
        MaxPooling(kernel=(3,3), stride=(2,2), padding="valid") ->
        Relu()
    ) ->
    Concatenate() ->
    FullyConnected(units=4096) ->
    Relu() ->
    Dropout() ->
    FullyConnected(units=4096) ->
    Relu() ->
    Dropout() ->
    FullyConnected(units=classes) ->
    Softmax() ->
    predictions
}